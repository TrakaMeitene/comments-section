(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),o=n(19),r=n.n(o),s=(n(27),n(3)),i=(n(28),n(0)),l=n(7).default;function u(e){var t=e.deletemodal,n=e.commentid,c=e.getalldata;return Object(i.jsx)("div",{className:"mask",children:Object(i.jsxs)("div",{className:"modal",children:[Object(i.jsx)("h3",{children:"Delete comment"}),Object(i.jsx)("p",{children:"Are you sure you want to delete this comment? This will remove the comment and can't be undone"}),Object(i.jsxs)("span",{children:[Object(i.jsx)("button",{className:"cancel",onClick:function(){t(!1)},children:"NO,CANCEL"}),Object(i.jsx)("button",{className:"accept",onClick:function(){l.delete("https://nodeprojectreact.herokuapp.com/delete/${commentid}",{data:{id:n}}).then((function(e){return console.log(e.data)})).catch((function(e){console.error("Error:",e)})).then((function(){t(!1),c()}))},children:"YES, DELETE"})]})]})})}var d=n.p+"static/media/icon-plus.0037a825.svg",j=n.p+"static/media/icon-minus.4aa6933c.svg",m=n(7).default;function h(e){var t=e.comment,n=e.id,a=e.getAllData,o=e.currentuser,r=e.comments,l=e.deletemodal,u=e.deletefromdb,p=Object(c.useState)(!1),b=Object(s.a)(p,2),f=b[0],O=b[1],g=Object(c.useState)(),v=Object(s.a)(g,2),x=v[0],D=v[1],w=Object(c.useState)(!1),S=Object(s.a)(w,2),y=S[0],N=S[1],E=Object(c.useState)(),k=Object(s.a)(E,2),C=k[0],T=k[1],A=[];Object(c.useEffect)((function(){if(void 0===t||null===t)return""}),[t]);for(var _=0;_<r.length;_++)"0"!==r[_].replyTo&&A.push(r[_]);var M=new Date,F=new Date(t.createdAt),R=M.getFullYear()-F.getFullYear(),L=M.getMonth()-F.getMonth(),P=Math.abs(new Date(t.createdAt).getDate()-(new Date).getDate()),H=Math.abs(new Date(t.createdAt).getHours()-(new Date).getHours()),B=M.getMinutes()-F.getMinutes(),I=M.getSeconds()-F.getSeconds(),U="";R>0&&R<2?U+=R+"year ago":R>=2?U=R+" years ago":L>0&&L>1?U=L+" months ago":1===L?U=L+" month ago":P>0&&P>1&&Math.floor(P)<7?U=Math.floor(P)+" days ago":1===Math.floor(P)?U=P+" day ago":1===Math.floor(P/7)?U="1 week ago":Math.floor(P/7)>1?U=Math.floor(P/7)+" weeks ago":B>0&&1===H?U="1 hour ago":H>1&&H<12?U=H+" hours ago":1===H&&B<0?U=(B=M.getMinutes()+60-F.getMinutes())+" minutes ago":B>0&&B>1?U=B+" minutes ago":1===B?U=B+" minute ago":I>0&&I>1?U=I+" seconds ago":1===I?U=I+" second ago":0===I&&(U="just now");for(var Y=function(e){var c=e.target.getAttribute("value");m.put("https://nodeprojectreact.herokuapp.com/score",{id:n,comment:t,type:c}).catch((function(e){alert(e)})).then((function(){a()}))},K=t.user.image.png,V=o[0].username,W=o[0].image.png,J=Object(i.jsxs)("div",{className:"comment-window",children:[Object(i.jsx)("div",{className:"avatar",children:Object(i.jsx)("img",{alt:"avatar",src:W})}),Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=[],c=(r.map((function(e){n.push(e.id)})),n.sort((function(e,t){return e-t}))),s={id:c[c.length-1]+1,content:x,createdAt:new Date,score:0,user:o[0],replyTo:t._id,type:"reply"};m.post("https://nodeprojectreact.herokuapp.com/addcomment",{newcomment:s}).catch((function(e){alert("Error:",e)})).then((function(){O(!1),D(""),a()}))},children:[Object(i.jsx)("textarea",{rows:"3",cols:"12",wrap:"hard",defaultValue:"@"+t.user.username+" ",onChange:function(e){D(e.target.value),e.preventDefault()}}),Object(i.jsx)("input",{type:"submit",value:"REPLY"})]})]}),$=t.content,q=$.split(" "),z="@"===$.split("")[0]?Object(i.jsxs)("p",{children:[Object(i.jsx)("b",{children:q[0]+" "}),$.substring($.indexOf(" ")+1)]}):Object(i.jsx)("p",{children:t.content}),G=[],Q=0;Q<A.length;Q++)for(var X=Q+1;X<r.length;X++)A[Q]._id===r[X].replyTo&&G.push(r[X]);return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"comment-window",children:[Object(i.jsxs)("div",{className:"vote-count",children:[Object(i.jsx)("img",{alt:"plus",src:d,onClick:Y,value:"plus"}),Object(i.jsx)("p",{children:t.score}),Object(i.jsx)("img",{alt:"minus",src:j,onClick:Y,value:"minus"})]}),Object(i.jsxs)("div",{className:"comment-column",children:[Object(i.jsxs)("div",{className:"comment-header",children:[Object(i.jsx)("img",{alt:"avatar",src:K}),Object(i.jsx)("p",{children:t.user.username}),Object(i.jsx)("span",{className:t.user.username===V?"you":"nodisplay",children:"you"}),Object(i.jsx)("p",{className:"cooment-date",children:U}),t.user.username===V?Object(i.jsxs)("div",{className:"delete",children:[Object(i.jsx)("p",{onClick:function(){l(!0),u(n)},children:"Delete"}),Object(i.jsx)("p",{onClick:function(){N(!0)},children:"Edit"})]}):Object(i.jsx)("p",{className:"reply",onClick:function(e){O(!0)},children:" Reply"})]}),Object(i.jsx)("div",{className:"content",children:y?Object(i.jsxs)("form",{className:"update",onSubmit:function(e){e.preventDefault();var c={_id:n,id:t.id,content:C,createdAt:t.createdAt,score:t.score,user:t.user,replyTo:t.replyTo};m.put("https://nodeprojectreact.herokuapp.com/edit",{params:c}).catch((function(e){alert(e)})).then((function(){a(),N(!1)}))},children:[Object(i.jsx)("textarea",{className:"editable",rows:"2",cols:"10",wrap:"hard",onChange:function(e){e.preventDefault(),T(e.target.value)},defaultValue:t.content}),Object(i.jsx)("input",{type:"submit",value:"UPDATE"})]}):z})]})]}),f?J:"",A.map((function(e){return t._id===e.replyTo?Object(i.jsx)("div",{className:G.includes(e)?"jauna":"repliedTo",children:Object(i.jsx)(h,{comment:e,id:e._id,getAllData:a,currentuser:o,comments:r,deletemodal:l,deletefromdb:u},e.id)},e.id):""}))]})}var p=n(7).default;function b(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(),r=Object(s.a)(o,2),l=r[0],d=r[1],j=Object(c.useState)(),m=Object(s.a)(j,2),b=m[0],f=m[1],O=Object(c.useState)(!1),g=Object(s.a)(O,2),v=g[0],x=g[1],D=Object(c.useState)(),w=Object(s.a)(D,2),S=w[0],y=w[1];Object(c.useEffect)((function(){N(),E()}),[]);var N=function(){p.get("https://nodeprojectreact.herokuapp.com").then((function(e){return d(e.data)})).catch((function(e){console.error("Error:",e)}))},E=function(){p.get("https://nodeprojectreact.herokuapp.com/user",{params:{name:"juliusomo"}}).then((function(e){return a(e.data)})).catch((function(e){console.error("Error:",e)}))},k=Object(c.useCallback)((function(e){x(e)}),[]),C=Object(c.useCallback)((function(e){y(e)}),[]);return void 0===l||null===l||void 0===n[0]||null===n[0]?"":Object(i.jsxs)(i.Fragment,{children:[l.map((function(e){return"0"===e.replyTo?Object(i.jsx)("div",{children:Object(i.jsx)(h,{comment:e,id:e._id,getAllData:N,currentuser:n,comments:l,deletemodal:k,deletefromdb:C},e.id)},e.id):""})),Object(i.jsxs)("div",{className:"comment-window",children:[Object(i.jsx)("div",{className:"avatar",children:Object(i.jsx)("img",{alt:"avatar",src:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/comments-section",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).DB_URI,"/assets/").concat(n[0].image.png)})}),Object(i.jsxs)("form",{onSubmit:function(e){var t=e.target[0].value;e.preventDefault();var c=[],a=(l.map((function(e){c.push(e.id)})),c.sort((function(e,t){return e-t}))),o={id:a[a.length-1]+1,content:t,createdAt:new Date,score:0,user:n[0],replyTo:"0"};p.post("https://nodeprojectreact.herokuapp.com/addcomment",{newcomment:o}).catch((function(e){alert("Error:",e)})).then((function(){f(""),N()}))},children:[Object(i.jsx)("textarea",{rows:"3",cols:"10",wrap:"hard",placeholder:"Add a comment...",onChange:function(e){f(e.target.value),e.preventDefault()},value:b}),Object(i.jsx)("input",{type:"submit",value:"SEND"})]})]}),v?Object(i.jsx)(u,{deletemodal:k,commentid:S,getalldata:N}):""]})}n(52);function f(){return Object(i.jsx)(b,{})}var O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),o(e),r(e)}))};r.a.createRoot(document.getElementById("root")).render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(f,{})})),O()}},[[53,1,2]]]);
//# sourceMappingURL=main.d4ceeca3.chunk.js.map